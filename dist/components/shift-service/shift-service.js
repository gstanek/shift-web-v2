angular.module("myApp.shiftService",["LocalStorageModule"]).service("shiftService",["$rootScope","localStorageService","$http","realmService","commonService",function(a,b,c,d,e){var f=this;this.getShifts=function(a){var b=d.getLocalRealm(),e="";b&&(e="?realm_id="+b.id),c({method:"GET",url:"http://127.0.0.1:8000/api/v1/shift"+e,headers:{"Content-Type":"application/json"}}).then(function(b){console.log("Success:"+JSON.stringify(b)),f.setLocalShifts(b.data,a)},function(a){console.log("Failure to Get Shifts:"+JSON.stringify(a)),alert("Something went wrong during the signup process.  Please try again.  If the problem persists, please check back later.")})},this.updateShift=function(a,b){return c({method:"PATCH",url:"http://127.0.0.1:8000/api/v1/shift/"+a,headers:{"Content-Type":"application/json"},data:b})},this.storeShift=function(a){var b=d.getLocalRealm();console.log("startDate = "+JSON.stringify(a.startDate)),console.log("endDate = "+JSON.stringify(a.endDate));var e=a.startDate;e.setHours(a.startTime.getHours()),e.setMinutes(a.startTime.getMinutes()),e.setSeconds(0),e.setMilliseconds(0);var f=a.endDate;f.setHours(a.endTime.getHours()),f.setMinutes(a.endTime.getMinutes()),f.setSeconds(0),f.setMilliseconds(0),console.log("parsedStartDate = "+JSON.stringify(e)),console.log("parsedEndDate = "+JSON.stringify(f));var g={start_datetime:e,end_datetime:f,available:!1,realm:b.id,comment:a.comment};return console.log("shift = "+JSON.stringify(g)),c({method:"POST",url:"http://127.0.0.1:8000/api/v1/shift/",headers:{"Content-Type":"application/json"},data:g})},this.deleteShift=function(a){return c({method:"DELETE",url:"http://127.0.0.1:8000/api/v1/shift/"+a,headers:{"Content-Type":"application/json"}})},this.setLocalShift=function(c,d){var f=this.getLocalShifts();f||(f=[]),g(f,"id",c.id),f.push(c),b.set("shifts",f),a.$broadcast("SHIFT_CHANGE_EVENT",f),d&&e.setPersonaDisplayState()},this.removeLocalShift=function(c,d){var f=this.getLocalShifts();f||(f=[]),g(f,"id",c),b.set("shifts",f),a.$broadcast("SHIFT_CHANGE_EVENT",f),d&&e.setPersonaDisplayState()},this.setLocalShifts=function(a,c){b.set("shifts",a),c&&e.setPersonaDisplayState()},this.getLocalShifts=function(){var a=b.get("shifts");return a&&0==a.length?null:a},this.removeLocalShifts=function(c){b.remove("shifts"),a.$broadcast("SHIFT_CHANGE_EVENT",null),c&&e.setPersonaDisplayState()};var g=function(a,b,c){for(var d=a.length;d--;)a[d]&&a[d].hasOwnProperty(b)&&arguments.length>2&&a[d][b]===c&&a.splice(d,1);return a}}]);