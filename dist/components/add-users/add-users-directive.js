angular.module("myApp").directive("addUsersDirective",["userService","realmService","shiftService",function(a,b,c){return{restrict:"E",scope:{save:"&onSave",cancel:"&onCancel",errorObj:"="},templateUrl:"components/add-users/add-users.html",link:function(d,e,f,g){d.isActiveRealm=b.isActiveRealm();var h=function(){var b=a.getLocalUser();if(b){var d=c.getLocalShifts();return d?!0:!1}return!1};d.isShiftPresent=function(){return h()},d.companyName=b.getRealmName(),d.formData={users:[{}],index:0},d.addAnother=function(){d.formData.users.push({})},d.removeIndex=function(a){console.log("index="+a),a>-1&&d.formData.users.splice(a,1)},d.addUsers=function(c){if(c.$valid){for(var e=b.getLocalRealm(),f=e.id,g=[],h=0;h<d.formData.users.length;h++)console.log("formUser:"+JSON.stringify(d.formData.users[h])),d.formData.users[h].email&&d.formData.users[h].first_name&&g.push(d.formData.users[h]);var i={realm_id:f,users:g};a.createUsers(i).then(function(b){console.log("Add Users Success:"+JSON.stringify(b)),a.setLocalCoworkers(i.users,!0),d.save()},function(a){console.log("Add Users Failure:"+JSON.stringify(a))})}else angular.forEach(c.$error,function(a){angular.forEach(a,function(a){a.$setTouched()})}),d.errorObj.detail="Please correct errors indicated above and resubmit"}}}}]);