angular.module("myApp.authService",["LocalStorageModule","myApp.userService"]).service("authService",["$rootScope","localStorageService","userService","$auth","$http",function(a,b,c,d,e){var f={id:"",firstName:"",lastName:"",preferredName:"",email:""};this.isAuthenticated=function(){var a=c.getActiveUser();return null==a?!1:!0},this.isAuthorized=function(a){var b=c.getActiveUser(),d=null;return null!=b&&null!=b.persona&&(d=b.persona.roles),null!=d&&d.indexOf(a)>-1?!0:!1},this.signup=function(a){return console.log("signup service credentials="+JSON.stringify(a)),e({method:"POST",url:"http://127.0.0.1:8000/api/v1/user/",headers:{"Content-Type":"application/json"},data:a})},this.login=function(a){var b={grant_type:"password",client_id:"GqtWKUGixAaG727XNqsNrVlgcpDQsZ4MgZLvYev1",username:a.email,password:a.password};return e({method:"POST",url:"http://localhost:8000/o/token/",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:b})},this.setToken=function(a){d.setToken(a)},this.logout=function(){var a=d.getToken(),b={grant_type:"password",client_id:"GqtWKUGixAaG727XNqsNrVlgcpDQsZ4MgZLvYev1",token:a};e({method:"POST",url:"http://localhost:8000/o/revoke_token/",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:b}).then(function(a){console.log("Success:"+JSON.stringify(a)),d.removeToken()},function(a){console.log("Failure:"+JSON.stringify(a))}),c.removeActiveUser()},this.getBestDisplayName=function(){return null!=f.preferredName?f.preferredName:null!=f.firstName?f.firstName:null!=f.email?f.email:"Guest"},this.getCompanyName=function(){return null!=f.persona&&null!=f.persona.realm&&f.persona.realm.realmName?f.persona.realm.realmName:"Company"},this.setIdentityMap=function(c){b.set("user",c),a.$broadcast("USER_CHANGE_EVENT",c)},this.getIdentityMap=function(){return b.get("user")},this.removeActiveUser=function(){b.remove("user"),a.$broadcast("USER_CHANGE_EVENT",f)}}]);