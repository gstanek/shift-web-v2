angular.module("ShiftOnTapApp").directive("addUsersDirective",["userService","realmService","shiftService",function(a,b,c){return{restrict:"E",scope:{save:"&onSave",cancel:"&onCancel",errorObj:"="},templateUrl:"components/directives/add-users/add-users.html",link:function(d,e,f,g){d.isActiveRealm=b.isActiveRealm();var h=function(){var b=a.getLocalUser();if(b){var d=c.getLocalShifts();return d?!0:!1}return!1};d.isShiftPresent=function(){return h()},d.userAttributes=[{Name:"firstName",Required:!0},{Name:"lastName",Required:!0},{Name:"email",Required:!0}],d.companyName=b.getRealmName(),d.formData={users:[{}],index:0},d.addAnother=function(){d.formData.users.push({})},d.removeIndex=function(a){console.log("index="+a),a>-1&&d.formData.users.splice(a,1)},d.addUsers=function(c){if(console.log("scope.formData="+JSON.stringify(d.formData)),c.$valid){var e=b.getLocalRealm(),f=e.id;console.log("users to add: "+JSON.stringify(d.formData.users));var g={realm_id:f,users:d.formData.users};a.createUsers(g).then(function(b){console.log("Add Users Success:"+JSON.stringify(b)),a.addLocalCoworkers(b.data,!0),d.save()},function(a){console.log("Add Users Failure:"+JSON.stringify(a))})}else c.$setSubmitted(),d.errorObj.detail="Please correct errors indicated above and resubmit"}}}}]);