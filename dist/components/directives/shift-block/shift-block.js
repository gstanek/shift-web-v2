angular.module("ShiftOnTapApp").directive("shiftBlock",["realmService","userService","shiftService","RealmWebSocket",function(a,b,c,d){return{scope:{shift:"="},templateUrl:"components/directives/shift-block/shift-block.html",link:function(a){a.$on("SHIFT_CHANGE_EVENT",function(b,c){a.availableShifts=c}),a.user=b.getLocalUser(),a.coworkers=b.getLocalCoworkers(),a.claim=function(a){d(a,!1,user.id)},a.reclaim=function(a){d(a,!1,void 0)},a.markAvailable=function(a){d(a,!0)};var d=function(a,b,d){var e={available:b};d&&(e.userID=d),c.updateShift(a,e).then(function(a){console.log("Success:"+JSON.stringify(a)),c.setLocalShift(a.data,!0)},function(a){console.log("Failure:"+JSON.stringify(a))})};a["delete"]=function(a){c.deleteShift(a).then(function(b){console.log("Success:"+JSON.stringify(b)),c.removeLocalShift(a,!0)},function(b){404==b.status&&c.removeLocalShift(a,!0),console.log("Failure:"+JSON.stringify(b))})};var e=function(){a.isShiftPresent=function(){return isShiftPresent()},a.availableShifts=c.getLocalShifts()};e()}}}]);